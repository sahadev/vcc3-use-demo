{"version":3,"file":"content.vue_vue_type_script_lang.mjs","sources":["../../../../../../packages/components/popper/src/content.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"popperContentRef\"\n    :style=\"contentStyle\"\n    :class=\"contentClass\"\n    role=\"tooltip\"\n    @mouseenter=\"(e) => $emit('mouseenter', e)\"\n    @mouseleave=\"(e) => $emit('mouseleave', e)\"\n  >\n    <slot />\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport {\n  computed,\n  defineComponent,\n  ref,\n  inject,\n  provide,\n  unref,\n  onMounted,\n  watch,\n} from 'vue'\nimport { createPopper } from '@popperjs/core'\nimport { PopupManager } from '@element-plus/utils/popup-manager'\nimport { POPPER_INJECTION_KEY, POPPER_CONTENT_INJECTION_KEY } from './tokens'\nimport { usePopperContentProps } from './popper'\nimport { buildPopperOptions, unwrapMeasurableEl } from './utils'\n\nexport default defineComponent({\n  name: 'ElPopperContent',\n  props: usePopperContentProps,\n  emits: ['mouseenter', 'mouseleave'],\n  setup(props) {\n    const { triggerRef, popperInstanceRef, contentRef } = inject(\n      POPPER_INJECTION_KEY,\n      undefined\n    )!\n    const popperContentRef = ref<HTMLElement | null>(null)\n    const arrowRef = ref<HTMLElement | null>(null)\n    const arrowOffset = ref<number>()\n    provide(POPPER_CONTENT_INJECTION_KEY, {\n      arrowRef,\n      arrowOffset,\n    })\n    const contentZIndex = computed(\n      () => props.zIndex || PopupManager.nextZIndex()\n    )\n\n    const contentStyle = computed(\n      () => [{ zIndex: unref(contentZIndex) }, props.popperStyle] as any\n    )\n\n    const contentClass = computed(() => [\n      {\n        'el-popper': true,\n        'is-pure': props.pure,\n        [`is-${props.effect}`]: !!props.effect,\n      },\n      props.popperClass,\n    ])\n\n    const createPopperInstance = ({\n      referenceEl,\n      popperContentEl,\n      arrowEl,\n    }) => {\n      const options = buildPopperOptions(props, {\n        arrowEl,\n        arrowOffset: unref(arrowOffset),\n      })\n\n      return createPopper(referenceEl, popperContentEl, options)\n    }\n\n    const updatePopper = () => {\n      unref(popperInstanceRef)?.update()\n    }\n\n    onMounted(() => {\n      let updateHandle: ReturnType<typeof watch>\n      watch(\n        () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef),\n        (val) => {\n          updateHandle?.()\n          if (val) {\n            popperInstanceRef.value?.destroy()\n            const popperContentEl = unref(popperContentRef)!\n            contentRef.value = popperContentEl\n            const arrowEl = unref(arrowRef)\n\n            const newInstance = createPopperInstance({\n              referenceEl: val,\n              popperContentEl: unref(popperContentRef)!,\n              arrowEl,\n            })\n            popperInstanceRef.value = newInstance\n\n            updateHandle = watch(\n              () => val!.getBoundingClientRect(),\n              () => {\n                updatePopper()\n              },\n              {\n                immediate: true,\n              }\n            )\n          } else {\n            popperInstanceRef.value = null\n          }\n        },\n        {\n          immediate: true,\n        }\n      )\n    })\n\n    return {\n      popperContentRef,\n      popperInstanceRef,\n      contentStyle,\n      contentClass,\n      updatePopper,\n    }\n  },\n})\n</script>\n"],"names":[],"mappings":";;;;;;;AA4BA,aAAe,eAAe,CAAC;;AAE/B,EAAE,KAAK,EAAE,qBAAqB;EAC5B,OAAO,CAAC,YAAY,EAAE;EACtB,KAAK,MAAM,EAAE;IACX,MAAM,EAAE,UAAU,EAAE;IACpB,MAAM;IACN,MAAM,QAAQ,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;UACrB,WAAW,GAAG;WACb,CAAC;;MAEN,WAAW;KACZ,CAAC,CAAC;IACH,MAAM,gBAAgB,QAAQ,CAAC;IAC/B,MAAM,YAAY,GAAG,QAAQ,CAAC,MAAM;UAC9B;MACJ;;QAEE,SAAS,EAAE,KAAK,KAAK;SACpB,CAAC,GAAG,EAAE,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM;;;KAGzC,CAAC,CAAC;UACG,oBAAoB,GAAG,CAAC;;;MAG5B,OAAO;;YAED,OAAO,GAAG;QACd,OAAO;QACP,WAAW,EAAE,KAAK,CAAC,WAAW,CAAC;OAChC;MACD,OAAO;KACR;;MAEC,IAAI,EAAE,CAAC;MACP,CAAC,EAAE,GAAG,KAAK;MACX;aACO;UACH;MACJ,MAAM,MAAM,kBAAkB,CAAC,KAAK,CAAC;QACnC,IAAI,EAAE,CAAC;QACP,gBAAgB,IAAI,GAAG,KAAK,CAAC;;;UAG3B,MAAM,eAAe,GAAG,KAAK,CAAC,gBAAgB,CAAC,CAAC;;;UAGhD,MAAM;YACJ,WAAW,EAAE,GAAG;;;WAGjB,CAAC,CAAC;UACH,iBAAiB,CAAC,KAAK,GAAG,WAAW;UACrC;YACE,YAAY,EAAE,CAAC;WAChB;YACC,SAAS,EAAE;WACZ,EAAE;eACE;2BACY,CAAC,QAAQ,IAAI,CAAC;;;;;;;;;kBASvB;;kBAEA;;;;;;;"}